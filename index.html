<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8">
  <title>Leantool – Mobil</title>

  <!-- iPhone / iOS meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="theme-color" content="#ffffff">
  <meta name="format-detection" content="telephone=no">

  <style>
    /* ====== Basvariabler & reset ====== */
    :root{
      --bg: #f6f7f9;
      --paper: #ffffff;
      --ink: #0f172a;
      --muted: #6b7280;
      --line: #e5e7eb;
      --brand: #111827;
      --accent: #2563eb;
      --radius: 16px;
      --tap: 48px; /* minsta touch-yta */
      --vh: 1vh;  /* uppdateras via JS för iOS */
      --fs: clamp(15px, 2.6vw, 16px);
      --fs-sm: clamp(12px, 2vw, 14px);
      --fs-lg: clamp(16px, 3.2vw, 18px);
      --safe-top: env(safe-area-inset-top);
      --safe-bottom: env(safe-area-inset-bottom);
      --safe-left: env(safe-area-inset-left);
      --safe-right: env(safe-area-inset-right);
    }
    *,*::before,*::after{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; padding:0; }
    body{
      font-family: system-ui, -apple-system, Segoe UI, Inter, Arial, sans-serif;
      font-size: var(--fs);
      color: var(--ink);
      background: var(--bg);
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
    }
    a{ color: inherit; text-decoration: none; }
    button{ font: inherit; color: inherit; background: none; border: none; padding: 0; }

    /* ====== App-lager ====== */
    .app{
      min-height: calc(var(--vh) * 100);
      display: grid;
      grid-template-rows: auto 1fr auto;
      grid-template-columns: 100%;
      padding-left: max(12px, var(--safe-left));
      padding-right: max(12px, var(--safe-right));
      background: var(--bg);
    }

    /* ====== Övre appbar ====== */
    .appbar{
      position: sticky;
      top: 0;
      z-index: 50;
      display: flex;
      align-items: center;
      gap: 10px;
      padding: calc(8px + var(--safe-top)) 4px 8px 4px;
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--line);
    }
    .appbar .title{
      font-weight: 700;
      letter-spacing: 0.2px;
      padding-left: 8px;
    }
    .appbar .spacer{ flex: 1; }
    .iconbtn{
      min-width: var(--tap);
      min-height: var(--tap);
      display: grid;
      place-items: center;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: #fff;
      box-shadow: 0 1px 1px rgba(0,0,0,.03);
    }

    /* ====== Innehållsyta ====== */
    main{
      padding: 12px 0 12px 0;
      overflow: hidden; /* så att inre scrolls funkar snyggt */
    }
    .view{
      display: none;
      height: 100%;
    }
    .view.active{ display: block; }

    /* Scrollcontainer för varje vy (för att undvika dubbel-scroll med bottombar) */
    .scroll{
      height: calc((var(--vh) * 100) - 64px - 64px - var(--safe-top) - var(--safe-bottom));
      overflow: auto;
      padding-bottom: 8px;
    }

    /* ====== Komponenter ====== */
    .card{
      background: var(--paper);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 12px;
      margin-bottom: 12px;
      box-shadow: 0 1px 1px rgba(0,0,0,.02);
    }
    .hstack{ display: flex; align-items: center; gap: 8px; }
    .vstack{ display: flex; flex-direction: column; gap: 8px; }
    .muted{ color: var(--muted); font-size: var(--fs-sm); }
    .btn{
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-height: var(--tap);
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: #fff;
      box-shadow: 0 1px 1px rgba(0,0,0,.03);
      gap: 8px;
    }
    .btn.primary{
      background: var(--accent);
      color: #fff;
      border-color: transparent;
    }

    /* Chippar / snabbutfilter */
    .chips{ display: flex; gap: 8px; overflow: auto; padding-bottom: 2px; }
    .chip{
      flex: 0 0 auto;
      min-height: 36px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: #fff;
      font-size: var(--fs-sm);
    }
    .chip.active{ background: #eef2ff; border-color:#c7d2fe; }

    /* Horisontell kanban (mobilvänlig) */
    .kanban{
      display: grid;
      grid-auto-flow: column;
      grid-auto-columns: 78%;
      gap: 12px;
      overflow-x: auto;
      padding-bottom: 2px;
      scroll-snap-type: x mandatory;
    }
    .col{
      scroll-snap-align: start;
      background: var(--paper);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 10px;
      display: flex; flex-direction: column; gap: 10px;
    }
    .col h3{ margin: 2px 4px 4px 4px; font-size: var(--fs-lg); }
    .task{
      background: #fff;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px;
      display: grid;
      gap: 6px;
    }
    .tag{
      display:inline-flex; align-items:center; gap:6px;
      padding: 4px 8px;
      border-radius: 999px;
      background:#f1f5f9; color:#0f172a; font-size: var(--fs-sm);
    }

    /* Tabell som blir skrollbar i sidled i mobil */
    .table-wrap{
      overflow-x:auto; -webkit-overflow-scrolling: touch;
      border:1px solid var(--line);
      border-radius: var(--radius);
      background:#fff;
    }
    table{ border-collapse: collapse; width: 720px; max-width: none; }
    th,td{ padding: 10px 12px; border-bottom: 1px solid var(--line); text-align: left; font-size: var(--fs-sm); }
    th{ background:#f8fafc; position: sticky; top: 0; z-index: 1; }

    /* ====== Nederkant – bottombar ====== */
    .bottombar{
      position: sticky;
      bottom: 0;
      z-index: 50;
      padding: 8px 0 calc(8px + var(--safe-bottom));
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(8px);
      border-top: 1px solid var(--line);
    }
    .tabs{
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
    }
    .tab{
      min-height: calc(var(--tap) - 6px);
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      gap: 4px;
      border-radius: 12px;
      border: 1px solid transparent;
      font-size: var(--fs-sm);
      padding: 6px;
    }
    .tab.active{
      background:#eef2ff;
      border-color:#c7d2fe;
    }

    /* ====== Små ikoner (inline SVG) ====== */
    .i{ width: 18px; height: 18px; }

    /* Desktop/Tablet lite bredare kolumner (men fortfarande mobil-first) */
    @media (min-width: 768px){
      .kanban{ grid-auto-columns: 33%; }
      table{ width: 100%; max-width: 100%; }
      .scroll{ height: calc((var(--vh) * 100) - 72px - 72px); }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Övre rad -->
    <header class="appbar">
      <div class="iconbtn" id="btnMenu" aria-label="Meny">
        <!-- menu icon -->
        <svg class="i" viewBox="0 0 24 24" fill="none"><path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      </div>
      <div class="title">Leantool</div>
      <div class="spacer"></div>
      <button class="iconbtn" id="btnSearch" aria-label="Sök">
        <svg class="i" viewBox="0 0 24 24" fill="none"><path d="m21 21-3.8-3.8M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      </button>
      <button class="iconbtn" id="btnAdd" aria-label="Lägg till">
        <svg class="i" viewBox="0 0 24 24" fill="none"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      </button>
    </header>

    <!-- Innehåll -->
    <main>
      <!-- Vy: Hem -->
      <section class="view active" id="view-home" role="region" aria-label="Hem">
        <div class="scroll">
          <div class="card vstack">
            <div class="hstack" style="justify-content: space-between;">
              <strong>Snabbfilter</strong>
              <button class="btn" id="btnClear">Rensa</button>
            </div>
            <div class="chips" id="chips">
              <button class="chip active" data-filter="today">Idag</button>
              <button class="chip" data-filter="week">Denna vecka</button>
              <button class="chip" data-filter="late">Försenade</button>
              <button class="chip" data-filter="safety">Säkerhet</button>
              <button class="chip" data-filter="quality">Kvalitet</button>
              <button class="chip" data-filter="delivery">Leverans</button>
            </div>
          </div>

          <div class="kanban" aria-label="Status">
            <div class="col">
              <h3>Backlog</h3>
              <div class="task">
                <div class="hstack" style="justify-content: space-between;">
                  <strong>Bygg “Shopfloor Board” v2</strong>
                  <span class="tag">IT</span>
                </div>
                <div class="muted">Ägare: Marie • Förfallo: 2025-10-05</div>
              </div>
              <div class="task">
                <strong>Inför KPI:er på formning</strong>
                <div class="muted">Ägare: Joakim • Förfallo: 2025-10-12</div>
              </div>
            </div>
            <div class="col">
              <h3>Pågående</h3>
              <div class="task">
                <div class="hstack" style="justify-content: space-between;">
                  <strong>Truckfritt flöde – F60</strong>
                  <span class="tag">Lean</span>
                </div>
                <div class="muted">Ägare: Martin • Nästa steg: Kanban-test</div>
              </div>
              <div class="task">
                <strong>SupplySync – leveranstid</strong>
                <div class="muted">Ägare: Anton • Pilot i vecka 41</div>
              </div>
            </div>
            <div class="col">
              <h3>Klart</h3>
              <div class="task">
                <strong>SMED-övning fräs</strong>
                <div class="muted">Sparade 6 min/byte</div>
              </div>
            </div>
          </div>

          <div class="card vstack">
            <strong>Kommande deadlines</strong>
            <div class="table-wrap">
              <table>
                <thead><tr><th>#</th><th>Aktivitet</th><th>Ägare</th><th>Datum</th><th>Status</th></tr></thead>
                <tbody>
                  <tr><td>1</td><td>Visual buffer F60</td><td>Marie</td><td>2025-10-03</td><td>Pågående</td></tr>
                  <tr><td>2</td><td>Kanban pilot screen</td><td>Martin</td><td>2025-10-07</td><td>Backlog</td></tr>
                  <tr><td>3</td><td>RTM 3.0 demo</td><td>Christian</td><td>2025-10-15</td><td>Planerad</td></tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="card vstack">
            <strong>Snabbåtgärder</strong>
            <div class="hstack" style="gap:10px; flex-wrap: wrap;">
              <button class="btn primary" id="quickAdd"><svg class="i" viewBox="0 0 24 24" fill="none"><path d="M12 5v14M5 12h14" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/></svg>Lägg aktivitet</button>
              <button class="btn" id="exportBtn"><svg class="i" viewBox="0 0 24 24" fill="none"><path d="M12 3v12m0 0 4-4m-4 4-4-4M4 21h16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>Export</button>
              <button class="btn" id="importBtn"><svg class="i" viewBox="0 0 24 24" fill="none"><path d="M12 21V9m0 0-4 4m4-4 4 4M4 3h16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>Import</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Vy: Aktiviteter -->
      <section class="view" id="view-activities" role="region" aria-label="Aktiviteter">
        <div class="scroll">
          <div class="card vstack">
            <strong>Aktivitetslista</strong>
            <div class="vstack" id="list">
              <!-- Exempelposter -->
              <div class="task">
                <strong>Gemba – formning</strong>
                <div class="muted">Idag 13:30 • Ägare: Team A</div>
              </div>
              <div class="task">
                <strong>Starta daglig Shopfloor Management</strong>
                <div class="muted">Imorgon 09:00 • Ägare: Linje B</div>
              </div>
            </div>
            <button class="btn primary" id="addItem">+ Ny aktivitet</button>
          </div>
        </div>
      </section>

      <!-- Vy: KPI -->
      <section class="view" id="view-kpi" role="region" aria-label="KPI">
        <div class="scroll">
          <div class="card vstack">
            <strong>KPI:er (exempel)</strong>
            <div class="hstack" style="justify-content: space-between;">
              <div class="vstack">
                <div class="muted">OTD</div>
                <div style="font-weight:700; font-size: 22px;">94%</div>
              </div>
              <div class="vstack">
                <div class="muted">Kvalitet</div>
                <div style="font-weight:700; font-size: 22px;">99.1%</div>
              </div>
              <div class="vstack">
                <div class="muted">Säkerhet</div>
                <div style="font-weight:700; font-size: 22px;">0 LTIs</div>
              </div>
            </div>
          </div>
          <div class="card vstack">
            <strong>Senaste avvikelser</strong>
            <div class="task">
              <strong>Fräs – vibrationsspår</strong>
              <div class="muted">Åtgärd: byt pinnfräs • Status: Aktiv</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Vy: Inställningar -->
      <section class="view" id="view-settings" role="region" aria-label="Inställningar">
        <div class="scroll">
          <div class="card vstack">
            <strong>Inställningar</strong>
            <label class="muted">Tema</label>
            <div class="hstack">
              <button class="btn" data-theme="light">Ljust</button>
              <button class="btn" data-theme="dark">Mörkt</button>
              <button class="btn" data-theme="auto">Auto</button>
            </div>
            <div class="muted">Tips: Lägg till på hemskärmen i Safari: Dela → ”Lägg till på hemskärmen”.</div>
          </div>
        </div>
      </section>
    </main>

    <!-- Nederkant: flikar -->
    <nav class="bottombar" aria-label="Navigering">
      <div class="tabs">
        <button class="tab active" data-target="home" aria-label="Hem">
          <svg class="i" viewBox="0 0 24 24" fill="none"><path d="m3 10 9-7 9 7v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-9Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/></svg>
          <span>Hem</span>
        </button>
        <button class="tab" data-target="activities" aria-label="Aktiviteter">
          <svg class="i" viewBox="0 0 24 24" fill="none"><path d="M7 8h10M7 12h10M7 16h6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
          <span>Aktiviteter</span>
        </button>
        <button class="tab" data-target="kpi" aria-label="KPI">
          <svg class="i" viewBox="0 0 24 24" fill="none"><path d="M4 12h4v8H4v-8Zm6-6h4v14h-4V6Zm6 10h4v4h-4v-4Z" stroke="currentColor" stroke-width="1.5"/></svg>
          <span>KPI</span>
        </button>
        <button class="tab" data-target="settings" aria-label="Inställningar">
          <svg class="i" viewBox="0 0 24 24" fill="none"><path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z"/><path d="M19.4 15a1.7 1.7 0 0 0 .34 1.88l.06.07a2 2 0 1 1-2.83 2.83l-.07-.06A1.7 1.7 0 0 0 15 19.4a1.7 1.7 0 0 0-1 .33 1.7 1.7 0 0 0-.82 1.46V21a2 2 0 1 1-4 0v-.12a1.7 1.7 0 0 0-.82-1.46 1.7 1.7 0 0 0-1-.33 1.7 1.7 0 0 0-1.88-.34l-.07.06A2 2 0 1 1 2.56 16l.06-.07A1.7 1.7 0 0 0 3.4 15a1.7 1.7 0 0 0-.33-1 1.7 1.7 0 0 0-1.46-.82H1.5a2 2 0 1 1 0-4h.12a1.7 1.7 0 0 0 1.46-.82 1.7 1.7 0 0 0 .33-1 1.7 1.7 0 0 0-.34-1.88l-.06-.07A2 2 0 1 1 5.5 2.56l.07.06A1.7 1.7 0 0 0 7 3.4c.36 0 .7-.12 1-.33.47-.32.77-.86.82-1.46V1.5a2 2 0 1 1 4 0v.12c.05.6.35 1.14.82 1.46.3.21.64.33 1 .33.64 0 1.25-.25 1.73-.74l.07-.06A2 2 0 1 1 21.44 8l-.06.07c-.32.47-.34 1.06-.34 1.63 0 .36.12.7.33 1 .32.47.86.77 1.46.82h.12a2 2 0 1 1 0 4h-.12c-.6.05-1.14.35-1.46.82-.21.3-.33.64-.33 1Z" stroke="currentColor" stroke-width="1.2" fill="none"/></svg>
          <span>Inställn.</span>
        </button>
      </div>
    </nav>
  </div>

  <script>
    // iOS 100vh-fix
    function setVH(){
      const vh = window.innerHeight * 0.01;
      document.documentElement.style.setProperty('--vh', `${vh}px`);
    }
    setVH();
    window.addEventListener('resize', setVH);
    window.addEventListener('orientationchange', setVH);

    // Enkel SPA-nav för bottombar
    const tabs = document.querySelectorAll('.tab');
    const views = {
      home: document.getElementById('view-home'),
      activities: document.getElementById('view-activities'),
      kpi: document.getElementById('view-kpi'),
      settings: document.getElementById('view-settings')
    };
    function activate(target){
      for(const v of Object.values(views)) v.classList.remove('active');
      views[target].classList.add('active');
      tabs.forEach(t => t.classList.toggle('active', t.dataset.target === target));
      // spara valt läge
      try{ localStorage.setItem('leantool_tab', target); }catch(e){}
    }
    tabs.forEach(t => t.addEventListener('click', ()=> activate(t.dataset.target)));
    // återställ senaste tab
    try{
      const saved = localStorage.getItem('leantool_tab');
      if(saved && views[saved]) activate(saved);
    }catch(e){}

    // Chips (snabbfilter) – bara UI-exempel
    const chips = document.getElementById('chips');
    const btnClear = document.getElementById('btnClear');
    chips?.addEventListener('click', (e)=>{
      const c = e.target.closest('.chip');
      if(!c) return;
      c.classList.toggle('active');
    });
    btnClear?.addEventListener('click', ()=>{
      chips?.querySelectorAll('.chip.active')?.forEach(el=> el.classList.remove('active'));
    });

    // Snabbt lägga till aktivitet (exempel)
    const list = document.getElementById('list');
    document.getElementById('addItem')?.addEventListener('click', ()=>{
      const el = document.createElement('div');
      el.className = 'task';
      el.innerHTML = `<strong>Ny aktivitet</strong><div class="muted">Skapad ${new Date().toLocaleDateString('sv-SE')}</div>`;
      list.prepend(el);
    });

    // Tema (exempel)
    const themeBtns = document.querySelectorAll('[data-theme]');
    themeBtns.forEach(b => b.addEventListener('click', ()=>{
      const t = b.dataset.theme;
      try{ localStorage.setItem('leantool_theme', t); }catch(e){}
      applyTheme(t);
    }));
    function applyTheme(t){
      if(t === 'dark'){
        document.documentElement.style.setProperty('--bg', '#0b1220');
        document.documentElement.style.setProperty('--paper', '#0f172a');
        document.documentElement.style.setProperty('--ink', '#e5e7eb');
        document.documentElement.style.setProperty('--line', '#1f2937');
      }else if(t === 'light'){
        document.documentElement.style.setProperty('--bg', '#f6f7f9');
        document.documentElement.style.setProperty('--paper', '#ffffff');
        document.documentElement.style.setProperty('--ink', '#0f172a');
        document.documentElement.style.setProperty('--line', '#e5e7eb');
      }else{ // auto
        const m = window.matchMedia('(prefers-color-scheme: dark)').matches;
        applyTheme(m ? 'dark' : 'light');
        return;
      }
    }
    try{
      const savedTheme = localStorage.getItem('leantool_theme') || 'auto';
      applyTheme(savedTheme);
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', ()=> {
        const t = localStorage.getItem('leantool_theme') || 'auto';
        if(t === 'auto') applyTheme('auto');
      });
    }catch(e){}
  </script>
</body>
</html>
